<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Tapering Window · FourierAnalysis</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><a href="../"><img class="logo" src="../assets/logo.png" alt="FourierAnalysis logo"/></a><h1>FourierAnalysis</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">FourierAnalysis Documentation</a></li><li><a class="toctext" href="../MainModule/">Main Module</a></li><li class="current"><a class="toctext" href>Tapering Window</a><ul class="internal"><li><a class="toctext" href="#TaperKind-1">TaperKind</a></li><li><a class="toctext" href="#Taper-1">Taper</a></li></ul></li><li><span class="toctext">frequency domain</span><ul><li><a class="toctext" href="../spectra/">Spectral Estimations</a></li><li><a class="toctext" href="../crossspectra/">Cross-Spectral Matrices</a></li><li><a class="toctext" href="../coherence/">Coherence Matrices</a></li><li><a class="toctext" href="../goertzel/">Goertzel&#39;s Algorithms</a></li></ul></li><li><span class="toctext">time-frequency(TF) domain</span><ul><li><a class="toctext" href="../timefrequency/">TF Representations</a></li><li><a class="toctext" href="../timefrequencyuni/">TF Univariate Measures</a></li><li><a class="toctext" href="../timefrequencybi/">TF Bivariate Measures </a></li></ul></li><li><span class="toctext">utilities</span><ul><li><a class="toctext" href="../plots/">Plots</a></li><li><a class="toctext" href="../tools/">Tools</a></li><li><a class="toctext" href="../fftw/">FFTW planners</a></li><li><a class="toctext" href="../filters/">Filter Banks</a></li><li><a class="toctext" href="../hilbert/">Hilbert Transform</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li><a href>Tapering Window</a></li></ul><a class="edit-page" href="https://github.com/Marco-Congedo/FourierAnalysis.jl/blob/master/docs/src/tapers.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Tapering Window</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="tapers.jl-1" href="#tapers.jl-1">tapers.jl</a></h1><p>This unit implements eight tapering windows and the discrete prolate spheroidal sequences, the latters via the <a href="https://github.com/JuliaDSP/DSP.jl">DSP</a> package.</p><h2><a class="nav-anchor" id="TaperKind-1" href="#TaperKind-1">TaperKind</a></h2><pre><code class="language-none">@enum TaperKind begin
    rectangular = 1
    triangular  = 2
    hann        = 3
    hamming     = 4
    blackman    = 5
    harris4     = 6
    riesz       = 7
    parzen      = 8
    slepian     = 9
end</code></pre><p>The Hann tapering window is also known as &#39;squared cosine&#39; window and the Riesz window is similar to window known as the &#39;cosine&#39; window.</p><p>The design of tapering windows implies a trade-off between the <em>equivalent noise bandwidth</em> (enb), the energy of the <em>first sidelobe</em> (fsl) and the rate of <em>sidelobe falloff</em> (slf). The characteristics of the implemented tapering windows are reported in the following table:</p><table><tr><th style="text-align: center">window</th><th style="text-align: center">notable points</th><th style="text-align: center">enb(bins)</th><th style="text-align: center">fsl(dB)</th><th style="text-align: center">slf(dB/octave)</th></tr><tr><td style="text-align: center">rectangular</td><td style="text-align: center">1 everywhere</td><td style="text-align: center">1</td><td style="text-align: center">-13</td><td style="text-align: center">- 6</td></tr><tr><td style="text-align: center">triangular</td><td style="text-align: center">0 at boundaries</td><td style="text-align: center">1.33</td><td style="text-align: center">-26</td><td style="text-align: center">-12</td></tr><tr><td style="text-align: center">hann</td><td style="text-align: center">0 at boundaries</td><td style="text-align: center">1.50</td><td style="text-align: center">-32</td><td style="text-align: center">-18</td></tr><tr><td style="text-align: center">hamming</td><td style="text-align: center">&gt;0 at boundaries</td><td style="text-align: center">1.36</td><td style="text-align: center">-43</td><td style="text-align: center">- 6</td></tr><tr><td style="text-align: center">blackman</td><td style="text-align: center">0 at boundaries</td><td style="text-align: center">1.73</td><td style="text-align: center">-58</td><td style="text-align: center">-18</td></tr><tr><td style="text-align: center">harris4</td><td style="text-align: center">&gt;0 at boundaries</td><td style="text-align: center">2</td><td style="text-align: center">-92</td><td style="text-align: center">- 6</td></tr><tr><td style="text-align: center">riesz</td><td style="text-align: center">0 at boundaries</td><td style="text-align: center">1.2</td><td style="text-align: center">-21</td><td style="text-align: center">-12</td></tr><tr><td style="text-align: center">parzen</td><td style="text-align: center">&gt;0 at boundaries</td><td style="text-align: center">1.92</td><td style="text-align: center">-53</td><td style="text-align: center">-24</td></tr></table><p>The harris4 tapering window features excellent first sidelobe (-92dB) and sidelob falloff (-6dB rate), at the expenses of the highest equivalent noise bandwidth among all. Since this latter parameter is not critical in many applications, this window is employed as default by all <em>FourierAnalysis</em> constructors of objects in the frequency domain.</p><p>For reducing the variance of the spectral estimations, use the (Slepian) <em>discrete prolate spheroidal sequences (dpss)</em> multi-tapering (see <a href="#FourierAnalysis.slepians"><code>slepians</code></a>).</p><h2><a class="nav-anchor" id="Taper-1" href="#Taper-1">Taper</a></h2><p>Tapering windows in <strong>FourirAnalysis</strong> are encapsulated in the following structure:</p><pre><code class="language-none">struct Taper
    y    :: Union{Vector{T}, Matrix{T}} where T&lt;:Real
    kind :: TaperKind
    α    :: Real
    n    :: Int
end</code></pre><p>The fields of the structure are:</p><ul><li><code>y</code>, a real vector holding the tapering window, but for Slepian multi-tapers, for which this is a matrix holding in its columns the dpss</li><li><code>kind</code>, the tapering window(s) as a <a href="#TaperKind-1">TaperKind</a></li><li><code>α</code>, a parameter for the tapering window(s). This is needed only for dpss</li><li><code>n</code>, the number of tapering windows. It is &gt;1 only for dpss.</li></ul><p>If you need to construct <em>Taper</em> objects for single tapering windows, use the universal <a href="#FourierAnalysis.taper"><code>taper</code></a> constructor. For constructing <em>dpss</em> use the specialized constructor <a href="#FourierAnalysis.slepians"><code>slepians</code></a>.</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="FourierAnalysis.taper" href="#FourierAnalysis.taper"><code>FourierAnalysis.taper</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">function taper( kind  :: TaperKind,
                wl    :: Int;
            α       :: Real    = 2.,
            n       :: Int     = ceil(Int, 2*α)-1,
            padding :: Int     = 0,
            type    :: Type{T} = Float64) where T&lt;:Union{Real, Complex}
</code></pre><p>Universal constructor of <a href="#Taper-1">Taper</a> objects, given a tapering window <code>kind</code>, of type <a href="#TaperKind-1">TaperKind</a> and the window length <code>wl</code>.</p><p>Return a vector of length <code>wl</code> for all types of tapers, but for the dpss (Slepian multi-tapers), for which return a matrix of size <code>wl</code> x <code>n</code>.</p><p>If optional keyword argument <code>padding</code> is &gt;0, then the actual window length will be <code>wl</code> + <code>padding</code>.</p><p>The <code>type</code> optional keyword argument can be use to specify the the type of elements of the typering window. By default, this is the <code>Float64</code> type.</p><p>Optional keywords arguments <code>α</code> and <code>n</code> currently apply only for slepian multi-tapering (<em>discrete prolate spheroidal sequences</em>):</p><p><code>α</code> is the <em>half bandwidth</em> (hbw) parameter as per the DSP.jl package. This unit is used in many dpss implementations and it is often reported that &quot;typical values&quot; for <code>α</code> are 2, 2.5, 3, 3.5 or 4. However, the optimal smoothing increases with the ratio between window length and sampling rate, thus these values in absolute terms are not useful. In fact, the larger the <em>hbw</em> and the higher <code>n</code>, the smoother the spectra will be (variance reduction). In order to overcome these difficulties, for Slepian&#39;s multitapering <em>FourirAnalysis</em> implements the <a href="#FourierAnalysis.slepians"><code>slepians</code></a> constructor, which allows the bandwidth parameter to be given in Hz and the number of tapering windows to be chosen automatically.</p><p><code>n</code> is the number of tapering windows. For slepian tapers this is the number of the discrete prolate spheroidal sequences. As in the DSP package, by default it is set to <code>ceil(Int, 2*α)-1</code>, however, depending on how large this number is, low eigenvalues may correspond to the last sequences, therefore those should be discarded.</p><p><strong>See</strong>: <a href="#FourierAnalysis.slepians"><code>slepians</code></a></p><p><strong>See also</strong>: <a href="#FourierAnalysis.taperinfo"><code>taperinfo</code></a></p><p><strong>Examples</strong>:</p><pre><code class="language-none">using FourierAnalysis, Plots

## Use the constructor
sr, t, f, a = 128, 128, 10, 0.5
# create a sinusoidal superimposed to white noise
v=sinusoidal(a, f, sr, t*16, 0) + randn(t*16)
# create a data matrix
X=broadcast(+, v, randn(t*16, 3))*randn(3, 3)
# compute spectra using hamming tapering window
H=taper(hamming, t)
S=spectra(X, sr, t; tapering=H)
# you can obtain the same thing with
S=spectra(X, sr, t; tapering=hamming)
# which will create the hamming tapering window on the fly,
# thus calling explicitly the constructor is interesting
# only if you need to reuse the same tapering window many times.

## Plot tapering windows
# using the standard plot function
tapers=[TaperKind(i) for i=1:8]
X=zeros(t, 8)
for i=1:8 X[:, i] = taper(tapers[i], t).y end
labels=[string(tapers[i]) for i=1:8]
plot(X; labels=labels)

# discrete prolate spheroid sequences
H=taper(slepian, t, α=4, n=7)
# This is a special plot function declared in the plots.jl unit
plot(H, title=&quot;Slepian Multi-tapering (dpss)&quot;)</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/Marco-Congedo/FourierAnalysis.jl/blob/a86ae0380f83877dd0f6fd838447d7af486ad1ee/src/tapers.jl#L57-L137">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="FourierAnalysis.slepians" href="#FourierAnalysis.slepians"><code>FourierAnalysis.slepians</code></a> — <span class="docstring-category">Function</span>.</div><div><div><p>Construct a <a href="#Taper-1">Taper</a> objects holding Slepian&#39;s multi-tapering <em>discrete prolate spheroidal sequences</em>, given sampling rate <code>sr</code>, window length <code>wl</code> and the <code>bandwidht</code> argument in Hz. For EEG data, 1&lt;=bandwidht&lt;=2 is an adequate choice.</p><p>The &#39;half-bandwidht&#39; parameter <code>α</code> used in the DSP package and in the universal <a href="#Taper-1">Taper</a> constructor is set as</p><pre><code class="language-none">    `α=(bandwidht/2)*wl/sr`.</code></pre><p>The optimal number of dpss is heuristically set to</p><pre><code class="language-none">    `n=max(1, trunc(Int, 2*α)-trunc(Int, log(2*α)))`.</code></pre><p>The created object can be passed as argument in constructors <a href="../spectra/#FourierAnalysis.spectra"><code>spectra</code></a>, <a href="../crossspectra/#FourierAnalysis.crossSpectra"><code>crossSpectra</code></a> and <a href="../coherence/#FourierAnalysis.coherence"><code>coherence</code></a>.</p><p><strong>Examples</strong>:</p><pre><code class="language-none">using FourierAnalysis, Plots
sr, t, f, a = 128, 128, 10, 0.5
# create a sinusoidal superimposed to white noise
v=sinusoidal(a, f, sr, t*16, 0) + randn(t*16)
# create a data matrix
X=broadcast(+, v, randn(t*16, 3))*randn(3, 3)
# compute spectra using slepian multi-tapering with bandwidth 1.5
S=spectra(X, sr, t; tapering=slepians(sr, t, 1.5))

## Plot dpss
H=slepians(sr, t*8, 2)
# This is a special plot function declared in the plots.jl unit
plot(H, title=&quot;Slepian multi-tapering (dpss)&quot;)</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/Marco-Congedo/FourierAnalysis.jl/blob/a86ae0380f83877dd0f6fd838447d7af486ad1ee/src/tapers.jl#L186-L223">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="FourierAnalysis.taperinfo" href="#FourierAnalysis.taperinfo"><code>FourierAnalysis.taperinfo</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">function taperinfo(taper::Taper)</code></pre><p>Return the name of the tapering window(s) encapsulated in the <a href="#Taper-1">Taper</a> object as a string.</p><p>Only for Slepian&#39;s discrete prolate spheroidal sequences (dpss), their parameters, namely, <span>$α$</span> (half-bandwidth) and <span>$n$</span> (number of windows), are reported within parentheses as well.</p><p><strong>Examples</strong>:</p><pre><code class="language-none">H=taper(hamming, 128*8)
taperinfo(H)

H=slepians(128, 128*8, 2)
taperinfo(H)</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/Marco-Congedo/FourierAnalysis.jl/blob/a86ae0380f83877dd0f6fd838447d7af486ad1ee/src/tapers.jl#L234-L253">source</a></section><p><strong>References</strong></p><p>F.J. Harris (1978) <a href="http://www.utdallas.edu/~cpb021000/EE%204361/Great%20DSP%20Papers/Harris%20on%20Windows.pdf">On the Use of Windows for Harmonic Analysis with the Discrete Fourier Transform</a> Proc. IEEE, 66, 51-53, 1978</p><p>D. Slepian (1978) <a href="https://ieeexplore-ieee-org.gaelnomade-1.grenet.fr/stamp/stamp.jsp?tp=&amp;arnumber=6771595">Prolate Spheroidal Wave Functions. Fourier Analysis, and Uncertainty—V: The Discrete Case</a> The Bell System Technical Journal,VoL 57, No. 5. May-June 1978</p><p>D.J. Thomson (1982) <a href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.471.1278&amp;rep=rep1&amp;type=pdf">Spectrum estimation and harmonic analysis</a> Proc. IEEE 70: 1055-1096, 1982.</p><p><a href="https://pdfs.semanticscholar.org/752d/1a551b96559458064323eb3de7faaaef4c4e.pdf">More resources</a></p><footer><hr/><a class="previous" href="../MainModule/"><span class="direction">Previous</span><span class="title">Main Module</span></a><a class="next" href="../spectra/"><span class="direction">Next</span><span class="title">Spectral Estimations</span></a></footer></article></body></html>
